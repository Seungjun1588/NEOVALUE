mutate(SALE17=SALE1 - diff(SALE1,7)) %>%
mutate(log_SALE1=log_SALE - diff(log_SALE,1)) %>%
mutate(log_SALE17=log_SALE1 - diff(log_SALE1,7)) -> kids1
# 1차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE1)) +
ggtitle("1차 차분")
# 1,7차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE17))+
ggtitle("1차&7차 차분")
adf.test(kids1 %>% select(SALE17) %>%  pull)
# 1차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE1)) +
ggtitle("1차 차분")
# 1,7차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE17))+
ggtitle("1차&7차 차분")
# 1차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE1)) +
ggtitle("1차 차분(로그)")
# 1차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE1)) +
ggtitle("1차 차분")
# 1,7차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE17))+
ggtitle("1차&7차 차분(로그)")
# 1,7차 차분
kids1 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE17))+
ggtitle("1차&7차 차분")
adf.test(kids1 %>% select(SALE17) %>%  pull)
kids2 %>%
mutate(SALE1=SALE - diff(SALE,1)) %>%
mutate(SALE17=SALE1 - diff(SALE1,7)) %>%
mutate(log_SALE1=log_SALE - diff(log_SALE,1)) %>%
mutate(log_SALE17=log_SALE1 - diff(log_SALE1,7)) -> kids2
# 1차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE1)) +
ggtitle("1차 차분(로그)")
# 1,7차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE17))+
ggtitle("1차&7차 차분(로그)")
# 1차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE1)) +
ggtitle("1차 차분")
# 1,7차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE17))+
ggtitle("1차&7차 차분")
adf.test(kids2 %>% select(log_SALE) %>%  pull)
adf.test(kids2 %>% select(log_SALE17) %>%  pull)
adf.test(kids2 %>% select(SALE17) %>%  pull)
# 1차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE1)) +
ggtitle("1차 차분(로그)")
# 1차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE1)) +
ggtitle("1차 차분")
# 1,7차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=log_SALE17))+
ggtitle("1차&7차 차분(로그)")
# 1,7차 차분
kids2 %>%
ggplot() +
geom_line(aes(x=DATE,y=SALE17))+
ggtitle("1차&7차 차분")
adf.test(kids2 %>% select(SALE17) %>%  pull)
auto.arima(kid1s %>% select(SALE) %>% pull)
library(TSA)
auto.arima(kid1s %>% select(SALE) %>% pull)
library(aTSA)
auto.arima(kid1s %>% select(SALE) %>% pull)
#### ARIMA모형 추정
library(forcast)
#### ARIMA모형 추정
library(forecast)
auto.arima(kid1s %>% select(SALE) %>% pull)
auto.arima(kids1 %>% select(SALE) %>% pull)
?auto.arima
source("C:/Seungjun/neovalue/NEOVALUE/NeoValueProject/code/TotalSalesAnalyss.R", echo=TRUE)
auto.arima(kids1 %>% select(SALE) %>% pull,seasonal = TRUE)
checkresiduals(kids1)
checkresiduals(kids1 %>% select(SALE) %>% pull)
fit <- arima(kids1 %>% select(SALE17) %>% pull ,
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7), method = "ML")
checkresiduals(kids1 %>% select(SALE17) %>% pull)
?as_tsibble
kids1 %>% as_tsibble()
kids1 %>% tsibble()
#-----------------------------------------------#
library(tsibble)
kids1 %>% tsibble()
kids1 %>% as_tsibble()
?as_tsibble
kids1 %>% as_tsibble(key=SALE)
kids1 %>% as_tsibble(origin=DATE,key=SALE)
kids1 %>% as_tsibble(index=DATE,key=SALE)
kids1 %>% as_tsibble(date=DATE,value=SALE)
kids1
kids1 %>%
select(DATE,SALE) %>%
tsibble()
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F)
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
acf(SALE) %>%
autoplot()
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
acf(SALE) %>%
autoplot
kids1 %>% select(SALE) %>% is.na %>% sum
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
ACF(SALE) %>%
autoplot
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
ACF(SALE)
library(tsibbledata)
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
ACF(SALE) %>%
autoplot
library(dplyr)
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
ACF(SALE) %>%
autoplot
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
dplyr::ACF(SALE) %>%
autoplot
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F)
kids1 %>%
select(DATE,SALE) %>%
tsibble(regular=F) %>%
ACF()
acf(kids1 %>% select(SALE))
pacf(kids1 %>% select(SALE))
acf(kids1 %>% select(SALE))
acf(kids1 %>% select(SALE17))
pacf(kids1 %>% select(SALE17))
mfrow(c(2,1))
par(mfrow=c(2,1))
acf(kids1 %>% select(SALE17))
pacf(kids1 %>% select(SALE17))
par(mfrow=c(1,2))
acf(kids1 %>% select(SALE17))
pacf(kids1 %>% select(SALE17))
par(mfrow=c(1,1))
acf(kids1 %>% select(SALE17),lag=30)
par(mfrow=c(1,2))
acf(kids1 %>% select(SALE17),lag=30)
pacf(kids1 %>% select(SALE17),lag=30)
par(mfrow=c(1,1))
fit <- arima(kids1 %>% select(SALE) %>% pull ,
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7), method = "ML")
fit
summary(fit)
acf(fit$residuals, lag.max = 35)
pacf(fit$residuals, lag.max = 35)
fore_fit =forecast(fit)
fit
fore_fit =forecast(fit)
checkresiduals(fit)
autoplot(fore_fit)
fore_fit =forecast(fit)
fit
checkresiduals(fit)
kids
kids %>% select(SALE)
kids
kids %>% filter(DATE == "2020-03-21")
View(kids)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(sampledat$SALES)>294)),
transfer=list(c(1,0) ),
)
data.frame(event=1*(seq(sampledat$SALES)>294))
dim(kids)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0) ),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(0,1) ),
)
?arimax
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>293)),
transfer=list(c(1,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>294),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
sampledat$SALES
seq(sampledat$SALES)
dim(kids)[1]
seq(dim(kids)[1])
1*(seq(dim(kids)[1])>294)
dim(kids)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>294),event=1*(seq(dim(kids)[1])<=294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>294),event=0*(seq(dim(kids)[1])<=294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(kids)>280),event=1*(seq(kids)>294)),
transfer=list(c(1,0),c(0,0)),
)
1*(seq(kids)>280)
(seq(dim(kids)[1])>280)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,3), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,1), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,5), seasonal = list(order=c(0,1,5), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,5), seasonal = list(order=c(0,0,0), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,0), seasonal = list(order=c(0,0,0), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,0), seasonal = list(order=c(0,1,0), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,1), seasonal = list(order=c(0,1,0), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(1,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event2=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(1,0)),
)
#-----------------------------------------------#
data(airmiles)
airmiles
log(airmiles)
plot(log(airmiles),ylab='Log(airmiles)',xlab='Year', main='')
acf(diff(diff(window(log(airmiles),end=c(2001,8)),12)),lag.max=48,main='')
air.m1=arimax(log(airmiles),order=c(0,1,1),seasonal=list(order=c(0,1,1),
period=12),xtransf=data.frame(I911=1*(seq(airmiles)==69),
I911=1*(seq(airmiles)==69)),
transfer=list(c(0,0),c(1,0)),xreg=data.frame(Dec96=1*(seq(airmiles)==12),
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84)),method='ML')
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
)
summary(fit.i)
acf(fit.i$residuals, lag.max = 35)
pacf(fit.i$residuals, lag.max = 35)
data.frame(event=1*(seq(dim(kids)[1])>280),event2=1*(seq(dim(kids)[1])>294))
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280),event2=1*(seq(dim(kids)[1])>294)),
transfer=list(c(1,0),c(0,0)),
)
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0),c(0,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0)),
)
?arimax
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0),(1,1)),
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0),c(1,1)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,1)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xregs=data.frame(event=1*(seq(dim(kids)[1])>280)),
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,1)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xreg=data.frame(event=1*(seq(dim(kids)[1])>280)),
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,1)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xreg=data.frame(event=1*(seq(dim(kids)[1])>280)),
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xreg=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,0)),
)
# 2020-03-21 -> index 294
fit.i = arimax(
kids %>% select(SALE),
order=c(0,1,2), seasonal = list(order=c(0,1,2), period=7),
method = "ML",
xtransf=data.frame(event=1*(seq(dim(kids)[1])>280)),
transfer=list(c(1,2)),
)
